<%= juggernaut(:client_id => current_user.id, :debug => false) %>
<div id="chatwindow">
  <table id="chat">
    <%= previous_messages %>
  </table>
</div>

<div id="chatbox">
  <%= form_remote_tag(
        :url => { :action => :new },
        :complete => "$('message').value = ''" ) %>
    <%= hidden_field_tag 'previous_speaker' %>
    <%= text_area_tag( 'message', '', { :rows => 4, :cols => 60, :id => 'message'} ) %>
    <%= submit_tag "Add" %>
  </form>
</div>  

<script type="text/javascript" charset="utf-8">
  Event.observe($('message'), 'keydown', function(e) {
    if (e.keyCode == 13 && e.shiftKey == false) {
      $('message').form.onsubmit();
      return false;
    }  
  });
</script>